<!-- ======================================================================= -->
<!-- APS                                                                     -->
<!--                                                                         -->
<!-- (C) Copyright 2015-2016 Vladimir Grechka                                -->
<!-- ======================================================================= -->

<project name="aps">
    <property environment="env"/>

    <include file="${env.INTO_KOMMON_HOME}/build-into-kommon-inc.xml" as="inc"/>

    <path id="cp">
        <path refid="into-kommon-jvm-classpath"/>
        <pathelement location="${env.APS_HOME}/back/out"/>
    </path>

    <target name="before-compilation">
    </target>

    <target name="after-compilation">
        <ant antfile="${env.INTO_KOMMON_HOME}/build-into-kommon.xml" target="after-compilation"/>

        <java classname="aps.LintShit" fork="true">
            <classpath refid="cp"/>
        </java>

        <antcall target="inc.enhance-js">
            <param name="inFile" value="${env.APS_HOME}/front/out/front.js"/>
        </antcall>

        <touch file="${env.APS_HOME}/back/restart-flag"/>
    </target>

    <target name="make-static-sites">
        <exec executable="node" dir="${env.APS_HOME}/front">
            <arg value="run.js"/>
            <arg value="MakeStaticSites"/>
            <arg value="--mode=debug"/>
        </exec>
    </target>
</project>

